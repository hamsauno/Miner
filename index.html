<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>WAYMORR - –°—Ç–∞—Ä—Ç</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <script src="js/fullscr.js" defer></script>
  <script src="js/nozoom.js" defer></script>

  <link rel="stylesheet" href="css/bg.css">
  
  <style>
    /* –ê–Ω–∏–º–∞—Ü–∏—è —Ñ–æ–Ω–∞ */
    @keyframes fadeToBlue {
      0% { background-color: #000000; }
      100% { background-color: #2511A8; }
    }
    /* –ê–Ω–∏–º–∞—Ü–∏—è –ø—É–ª—å—Å–∞—Ü–∏–∏ */
    @keyframes pulse {
      0%, 100% { transform: scale(1); opacity: 1; }
      50% { transform: scale(1.1); opacity: 0.7; }
    }
    body, html {
      margin: 0;
      padding: 0;
      height: 100%;
      overflow: hidden;
      font-family: 'Arial', sans-serif;
      background-color: #000000;
      animation: fadeToBlue 2s forwards;
    }
  </style>
</head>
<body class="flex flex-col items-center justify-center text-white">

<!-- –¶–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
<div id="startScreen" class="flex flex-col items-center justify-center w-full h-full relative">
  <img src="img/WAYMORR.png" alt="WAYMORR" class="w-[80%] max-w-xs sm:max-w-sm md:max-w-md lg:max-w-lg mb-8 transition-all duration-700" />
  <p id="slogan" class="text-center text-lg sm:text-xl mt-4 px-4 opacity-0 transition-opacity duration-1000"></p>

  <button id="startButton" class="text-2xl sm:text-3xl font-bold animate-pulse px-12 py-4" style="animation: pulse 2s infinite;">
    –ù–ê–ß–ê–¢–¨
  </button>

  <!-- –î–∏—Å–∫–ª–µ–π–º–µ—Ä –≤–Ω–∏–∑—É -->
  <div class="absolute bottom-4 text-xs text-center px-4 text-white opacity-60">
    –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è, –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω–∞—è –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –¥–ª—è –æ–∑–Ω–∞–∫–æ–º–∏—Ç–µ–ª—å–Ω—ã—Ö —Ü–µ–ª–µ–π –∏ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –ø—É–±–ª–∏—á–Ω–æ–π –æ—Ñ–µ—Ä—Ç–æ–π, –æ–ø—Ä–µ–¥–µ–ª—è–µ–º–æ–π –ø–æ–ª–æ–∂–µ–Ω–∏—è–º–∏ –°—Ç–∞—Ç—å–∏ 437 (2) –ì–ö –†–§
  </div>
</div>

  <!-- –°–∫—Ä–∏–ø—Ç—ã -->
  <script type="module">
    import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm";
    
    const supabaseUrl = "https://yiprwrgmyqlkdmhgulmc.supabase.co";
    const supabaseKey = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlpcHJ3cmdteXFsa2RtaGd1bG1jIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDQ2NTI0NjgsImV4cCI6MjA2MDIyODQ2OH0.lfiTfr5ukGDEVuwq-X9U2kWs3nEZrp3N443HT5AkbfI"; // –≤–∞—à –∫–ª—é—á
    const supabaseClient = createClient(supabaseUrl, supabaseKey);
    
    document.addEventListener("DOMContentLoaded", async () => {
      const tg = window.Telegram?.WebApp;
      tg?.ready();
    
      const user = tg?.initDataUnsafe?.user;
    
      if (!user) {
        alert("‚ùóÔ∏è –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Telegram.");
        return;
      }
    
      const telegramId = user.id.toString();
      const username = user.username || "";
      const timestamp = new Date().toISOString();
    
      const { error: visitError } = await supabaseClient
        .from("visits")
        .insert([{ telegram_id: telegramId, username, timestamp }]);
    
      if (visitError) {
        console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –≤–∏–∑–∏—Ç–∞:", visitError.message);
      } else {
        console.log("‚úÖ –í–∏–∑–∏—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω");
      }
    
      const startButton = document.getElementById("startButton");
      const startScreen = document.getElementById("startScreen");
    
      if (!startButton || !startScreen) return;
    
      startButton.addEventListener("click", async () => {
        startButton.disabled = true;
    
        try {
          const { data, error } = await supabaseClient
            .from("users")
            .select("*")
            .eq("telegram_id", telegramId);
    
          if (error) {
            console.error("–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞:", error.message);
            alert("–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.");
            return;
          }
    
          if (!data || data.length === 0) {
            const { error: insertError } = await supabaseClient
              .from("users")
              .insert([{ telegram_id: telegramId, username, bonus: 0, tutor: false  }]);
    
            if (insertError) {
              console.error("–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:", insertError.message);
              alert("–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏.");
              return;
            }
    
            console.log("üÜï –ù–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω");
          } else {
            console.log("‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–π–¥–µ–Ω:", data[0]);
          }
    
          startScreen.classList.add("opacity-0", "transition-opacity", "duration-700");
          setTimeout(() => {
            window.location.href = "home.html";
          }, 800);
        } catch (err) {
          console.error("–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞:", err);
          alert("–ù–µ —É–¥–∞–ª–æ—Å—å –≤—ã–ø–æ–ª–Ω–∏—Ç—å –≤—Ö–æ–¥.");
        }
      });
    });
    </script>
    <script>
      const slogans = [
      "–£—Å–ø–µ—à–Ω—ã–π –º–∞–π–Ω–∏–Ω–≥ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å —Å–∏–ª—å–Ω–æ–π –º–∞—Ç–µ–º–∞—Ç–∏–∫–∏",
      "–î–ª—è —Ç–µ—Ö, –∫—Ç–æ –≤—ã–±–∏—Ä–∞–µ—Ç —Å—á–∏—Ç–∞—Ç—å, –∞ –Ω–µ –Ω–∞–¥–µ—è—Ç—å—Å—è",
      "–ú–∞–π–Ω–∏–Ω–≥ –ø–æ–¥ –∫–ª—é—á –¥–ª—è —Ç–µ—Ö, –∫—Ç–æ –¥–æ–≤–µ—Ä—è–µ—Ç —Ü–∏—Ñ—Ä–∞–º"
      ];

      let sloganIndex = 0;
      const sloganElement = document.getElementById("slogan");

      function showNextSlogan() {
      if (!sloganElement) return;

      sloganElement.classList.remove("opacity-100");
      sloganElement.classList.add("opacity-0");

      setTimeout(() => {
        sloganElement.textContent = slogans[sloganIndex];
        sloganElement.classList.remove("opacity-0");
        sloganElement.classList.add("opacity-100");
        
        sloganIndex = (sloganIndex + 1) % slogans.length;
      }, 500);
      }

      // –ó–∞–ø—É—Å–∫–∞–µ–º —Ü–∏–∫–ª –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ª–æ–∑—É–Ω–≥–æ–≤ –∫–∞–∂–¥—ã–µ 4 —Å–µ–∫—É–Ω–¥—ã
      showNextSlogan();
      setInterval(showNextSlogan, 4000);
    </script>
    
</body>
</html>
